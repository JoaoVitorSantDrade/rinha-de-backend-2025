
 worker Pulling 
 api1 Pulling 
 api2 Pulling 
 9824c27679d3 Already exists 
 745a1af2fe11 Pulling fs layer 
 8b2f30be98c9 Pulling fs layer 
 248989e68cb2 Pulling fs layer 
 3fae5fcc6b87 Pulling fs layer 
 019821b62a2b Pulling fs layer 
 3fae5fcc6b87 Waiting 
 019821b62a2b Waiting 
 9824c27679d3 Already exists 
 745a1af2fe11 Pulling fs layer 
 8b2f30be98c9 Pulling fs layer 
 248989e68cb2 Pulling fs layer 
 3fae5fcc6b87 Pulling fs layer 
 019821b62a2b Pulling fs layer 
 019821b62a2b Waiting 
 3fae5fcc6b87 Waiting 
 248989e68cb2 Downloading [=>                                                 ]     935B/44.26kB
 248989e68cb2 Downloading [=>                                                 ]     935B/44.26kB
 248989e68cb2 Downloading [==================================================>]  44.26kB/44.26kB
 248989e68cb2 Downloading [==================================================>]  44.26kB/44.26kB
 248989e68cb2 Verifying Checksum 
 248989e68cb2 Download complete 
 248989e68cb2 Verifying Checksum 
 248989e68cb2 Download complete 
 745a1af2fe11 Downloading [==================================================>]      93B/93B
 745a1af2fe11 Verifying Checksum 
 745a1af2fe11 Download complete 
 745a1af2fe11 Downloading [==================================================>]      93B/93B
 745a1af2fe11 Extracting [==================================================>]      93B/93B
 745a1af2fe11 Verifying Checksum 
 745a1af2fe11 Download complete 
 745a1af2fe11 Extracting [==================================================>]      93B/93B
 745a1af2fe11 Extracting [==================================================>]      93B/93B
 745a1af2fe11 Extracting [==================================================>]      93B/93B
 8b2f30be98c9 Downloading [==================================================>]     328B/328B
 8b2f30be98c9 Verifying Checksum 
 8b2f30be98c9 Download complete 
 8b2f30be98c9 Downloading [==================================================>]     328B/328B
 8b2f30be98c9 Verifying Checksum 
 8b2f30be98c9 Download complete 
 745a1af2fe11 Pull complete 
 745a1af2fe11 Pull complete 
 8b2f30be98c9 Extracting [==================================================>]     328B/328B
 8b2f30be98c9 Extracting [==================================================>]     328B/328B
 8b2f30be98c9 Extracting [==================================================>]     328B/328B
 8b2f30be98c9 Extracting [==================================================>]     328B/328B
 9824c27679d3 Already exists 
 8b2f30be98c9 Pull complete 
 8b2f30be98c9 Pull complete 
 745a1af2fe11 Already exists 
 248989e68cb2 Extracting [=====================================>             ]  32.77kB/44.26kB
 248989e68cb2 Extracting [=====================================>             ]  32.77kB/44.26kB
 248989e68cb2 Extracting [==================================================>]  44.26kB/44.26kB
 248989e68cb2 Extracting [==================================================>]  44.26kB/44.26kB
 8b2f30be98c9 Already exists 
 248989e68cb2 Pulling fs layer 
 3fae5fcc6b87 Pulling fs layer 
 019821b62a2b Pulling fs layer 
 019821b62a2b Waiting 
 248989e68cb2 Extracting [==================================================>]  44.26kB/44.26kB
 3fae5fcc6b87 Waiting 
 248989e68cb2 Pull complete 
 248989e68cb2 Pull complete 
 248989e68cb2 Pull complete 
 019821b62a2b Downloading [>                                                  ]  82.45kB/7.855MB
 019821b62a2b Downloading [>                                                  ]  82.45kB/7.855MB
 019821b62a2b Downloading [>                                                  ]  82.45kB/7.855MB
 3fae5fcc6b87 Downloading [>                                                  ]  81.75kB/7.847MB
 3fae5fcc6b87 Downloading [>                                                  ]  81.75kB/7.847MB
 3fae5fcc6b87 Downloading [>                                                  ]  81.75kB/7.847MB
 019821b62a2b Verifying Checksum 
 019821b62a2b Verifying Checksum 
 019821b62a2b Download complete 
 019821b62a2b Verifying Checksum 
 019821b62a2b Download complete 
 019821b62a2b Download complete 
 3fae5fcc6b87 Downloading [=======================>                           ]  3.632MB/7.847MB
 3fae5fcc6b87 Downloading [=======================>                           ]  3.632MB/7.847MB
 3fae5fcc6b87 Downloading [=======================>                           ]  3.632MB/7.847MB
 3fae5fcc6b87 Verifying Checksum 
 3fae5fcc6b87 Download complete 
 3fae5fcc6b87 Verifying Checksum 
 3fae5fcc6b87 Verifying Checksum 
 3fae5fcc6b87 Download complete 
 3fae5fcc6b87 Download complete 
 3fae5fcc6b87 Extracting [>                                                  ]   98.3kB/7.847MB
 3fae5fcc6b87 Extracting [>                                                  ]   98.3kB/7.847MB
 3fae5fcc6b87 Extracting [>                                                  ]   98.3kB/7.847MB
 3fae5fcc6b87 Extracting [=================================================> ]  7.766MB/7.847MB
 3fae5fcc6b87 Extracting [=================================================> ]  7.766MB/7.847MB
 3fae5fcc6b87 Extracting [=================================================> ]  7.766MB/7.847MB
 3fae5fcc6b87 Extracting [==================================================>]  7.847MB/7.847MB
 3fae5fcc6b87 Extracting [==================================================>]  7.847MB/7.847MB
 3fae5fcc6b87 Extracting [==================================================>]  7.847MB/7.847MB
 3fae5fcc6b87 Extracting [==================================================>]  7.847MB/7.847MB
 3fae5fcc6b87 Extracting [==================================================>]  7.847MB/7.847MB
 3fae5fcc6b87 Extracting [==================================================>]  7.847MB/7.847MB
 3fae5fcc6b87 Pull complete 
 3fae5fcc6b87 Pull complete 
 3fae5fcc6b87 Pull complete 
 019821b62a2b Extracting [>                                                  ]   98.3kB/7.855MB
 019821b62a2b Extracting [>                                                  ]   98.3kB/7.855MB
 019821b62a2b Extracting [>                                                  ]   98.3kB/7.855MB
 019821b62a2b Extracting [=================================================> ]  7.766MB/7.855MB
 019821b62a2b Extracting [=================================================> ]  7.766MB/7.855MB
 019821b62a2b Extracting [=================================================> ]  7.766MB/7.855MB
 019821b62a2b Extracting [==================================================>]  7.855MB/7.855MB
 019821b62a2b Extracting [==================================================>]  7.855MB/7.855MB
 019821b62a2b Extracting [==================================================>]  7.855MB/7.855MB
 019821b62a2b Extracting [==================================================>]  7.855MB/7.855MB
 019821b62a2b Extracting [==================================================>]  7.855MB/7.855MB
 019821b62a2b Extracting [==================================================>]  7.855MB/7.855MB
 019821b62a2b Pull complete 
 019821b62a2b Pull complete 
 019821b62a2b Pull complete 
 api2 Pulled 
 worker Pulled 
 api1 Pulled 
 Network payment-proxy_backend  Creating
 Network payment-proxy_backend  Created
 Container payment-db  Creating
 Container redis  Creating
 Container redis  Created
 Container payment-db  Created
 Container worker  Creating
 Container api1  Creating
 Container api2  Creating
 Container api2  Created
 Container worker  Created
 Container api1  Created
 Container nginx-lb  Creating
 Container nginx-lb  Created
Attaching to api1, api2, nginx-lb, payment-db, redis, worker
payment-db  | The files belonging to this database system will be owned by user "postgres".
payment-db  | This user must also own the server process.
payment-db  | 
payment-db  | The database cluster will be initialized with locale "en_US.utf8".
payment-db  | The default database encoding has accordingly been set to "UTF8".
payment-db  | The default text search configuration will be set to "english".
payment-db  | 
payment-db  | Data page checksums are disabled.
payment-db  | 
payment-db  | fixing permissions on existing directory /var/lib/postgresql/data ... ok
payment-db  | creating subdirectories ... ok
payment-db  | selecting dynamic shared memory implementation ... posix
payment-db  | selecting default "max_connections" ... 100
redis       | Starting Redis Server
payment-db  | selecting default "shared_buffers" ... 128MB
redis       | 1:C 04 Aug 2025 13:28:40.805 # WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.
redis       | 1:C 04 Aug 2025 13:28:40.805 * oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
redis       | 1:C 04 Aug 2025 13:28:40.805 * Redis version=8.0.3, bits=64, commit=00000000, modified=1, pid=1, just started
redis       | 1:C 04 Aug 2025 13:28:40.805 * Configuration loaded
redis       | 1:M 04 Aug 2025 13:28:40.805 * monotonic clock: POSIX clock_gettime
redis       | 1:M 04 Aug 2025 13:28:40.806 * Running mode=standalone, port=6379.
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> RedisBloom version 8.0.1 (Git=unknown)
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> Registering configuration options: [
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> 	{ bf-error-rate       :      0.01 }
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> 	{ bf-initial-size     :       100 }
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> 	{ bf-expansion-factor :         2 }
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> 	{ cf-bucket-size      :         2 }
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> 	{ cf-initial-size     :      1024 }
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> 	{ cf-max-iterations   :        20 }
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> 	{ cf-expansion-factor :         1 }
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> 	{ cf-max-expansions   :        32 }
redis       | 1:M 04 Aug 2025 13:28:40.806 * <bf> ]
redis       | 1:M 04 Aug 2025 13:28:40.807 * Module 'bf' loaded from /usr/local/lib/redis/modules//redisbloom.so
redis       | 1:M 04 Aug 2025 13:28:40.808 * <search> Redis version found by RedisSearch : 8.0.3 - oss
redis       | 1:M 04 Aug 2025 13:28:40.808 * <search> RediSearch version 8.0.1 (Git=5688fcc)
redis       | 1:M 04 Aug 2025 13:28:40.808 * <search> Low level api version 1 initialized successfully
redis       | 1:M 04 Aug 2025 13:28:40.808 * <search> gc: ON, prefix min length: 2, min word length to stem: 4, prefix max expansions: 200, query timeout (ms): 500, timeout policy: return, cursor read size: 1000, cursor max idle (ms): 300000, max doctable size: 1000000, max number of search results:  1000000, 
redis       | 1:M 04 Aug 2025 13:28:40.808 * <search> Initialized thread pools!
redis       | 1:M 04 Aug 2025 13:28:40.808 * <search> Disabled workers threadpool of size 0
redis       | 1:M 04 Aug 2025 13:28:40.808 * <search> Subscribe to config changes
redis       | 1:M 04 Aug 2025 13:28:40.808 * <search> Enabled role change notification
redis       | 1:M 04 Aug 2025 13:28:40.809 * <search> Cluster configuration: AUTO partitions, type: 0, coordinator timeout: 0ms
redis       | 1:M 04 Aug 2025 13:28:40.809 * <search> Register write commands
redis       | 1:M 04 Aug 2025 13:28:40.809 * Module 'search' loaded from /usr/local/lib/redis/modules//redisearch.so
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> RedisTimeSeries version 80001, git_sha=577bfa8b5909e7ee572f0b651399be8303dc6641
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> Redis version found by RedisTimeSeries : 8.0.3 - oss
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> Registering configuration options: [
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> 	{ ts-compaction-policy   :              }
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> 	{ ts-num-threads         :            3 }
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> 	{ ts-retention-policy    :            0 }
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> 	{ ts-duplicate-policy    :        block }
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> 	{ ts-chunk-size-bytes    :         4096 }
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> 	{ ts-encoding            :   compressed }
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> 	{ ts-ignore-max-time-diff:            0 }
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> 	{ ts-ignore-max-val-diff :     0.000000 }
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> ]
redis       | 1:M 04 Aug 2025 13:28:40.809 * <timeseries> Detected redis oss
redis       | 1:M 04 Aug 2025 13:28:40.810 * Module 'timeseries' loaded from /usr/local/lib/redis/modules//redistimeseries.so
redis       | 1:M 04 Aug 2025 13:28:40.810 * <ReJSON> Created new data type 'ReJSON-RL'
redis       | 1:M 04 Aug 2025 13:28:40.810 * <ReJSON> version: 80001 git sha: unknown branch: unknown
redis       | 1:M 04 Aug 2025 13:28:40.810 * <ReJSON> Exported RedisJSON_V1 API
redis       | 1:M 04 Aug 2025 13:28:40.810 * <ReJSON> Exported RedisJSON_V2 API
redis       | 1:M 04 Aug 2025 13:28:40.810 * <ReJSON> Exported RedisJSON_V3 API
redis       | 1:M 04 Aug 2025 13:28:40.810 * <ReJSON> Exported RedisJSON_V4 API
redis       | 1:M 04 Aug 2025 13:28:40.810 * <ReJSON> Exported RedisJSON_V5 API
redis       | 1:M 04 Aug 2025 13:28:40.810 * <ReJSON> Enabled diskless replication
redis       | 1:M 04 Aug 2025 13:28:40.810 * <ReJSON> Initialized shared string cache, thread safe: false.
redis       | 1:M 04 Aug 2025 13:28:40.810 * Module 'ReJSON' loaded from /usr/local/lib/redis/modules//rejson.so
redis       | 1:M 04 Aug 2025 13:28:40.810 * <search> Acquired RedisJSON_V5 API
redis       | 1:M 04 Aug 2025 13:28:40.811 * Server initialized
redis       | 1:M 04 Aug 2025 13:28:40.811 * Ready to accept connections tcp
payment-db  | selecting default time zone ... UTC
payment-db  | creating configuration files ... ok
api2        | Running 'server'...
api2        | 2025/08/04 13:28:41 INFO server started on :9999
worker      | Running 'worker'...
worker      | [INFO] Starting Redis Queue with 4 workers
api1        | Running 'server'...
api1        | 2025/08/04 13:28:41 INFO server started on :9999
nginx-lb    | /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
nginx-lb    | /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
nginx-lb    | /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
nginx-lb    | 10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
nginx-lb    | 10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
nginx-lb    | /docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
nginx-lb    | /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
nginx-lb    | /docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
nginx-lb    | /docker-entrypoint.sh: Configuration complete; ready for start up
payment-db  | running bootstrap script ... ok
worker      | [health] 0 UP (1)ms
worker      | [health] 1 UP (1)ms
payment-db  | sh: locale: not found
payment-db  | 2025-08-04 13:28:42.509 UTC [36] WARNING:  no usable system locales were found
payment-db  | performing post-bootstrap initialization ... ok
payment-db  | syncing data to disk ... ok
payment-db  | 
payment-db  | 
payment-db  | Success. You can now start the database server using:
payment-db  | 
payment-db  |     pg_ctl -D /var/lib/postgresql/data -l logfile start
payment-db  | 
payment-db  | initdb: warning: enabling "trust" authentication for local connections
payment-db  | initdb: hint: You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb.
payment-db  | waiting for server to start.... done
payment-db  | server started
payment-db  | CREATE DATABASE
payment-db  | 
payment-db  | 
payment-db  | /usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/init.sql
payment-db  | CREATE TABLE
payment-db  | CREATE INDEX
payment-db  | 
payment-db  | 
payment-db  | waiting for server to shut down.... done
payment-db  | server stopped
payment-db  | 
payment-db  | PostgreSQL init process complete; ready for start up.
payment-db  | 
worker      | [health] 0 UP (1)ms
worker      | [health] 1 UP (1)ms
worker      | [health] 0 UP (1)ms
worker      | [health] 1 UP (1)ms
api1        | [INFO] Cleared stream payment_stream
worker      | [health] 0 UP (1)ms
worker      | [health] 1 UP (1)ms
worker      | [health] 0 UP (1)ms
worker      | [health] 1 UP (1)ms
worker      | [health] 0 UP (100)ms
worker      | [health] 1 UP (1)ms
worker      | [health] 1 UP (1)ms
worker      | [health] 0 UP (100)ms
worker      | [health] 0 DOWN (100)ms
worker      | [health] 1 UP (1)ms
worker      | [health] 0 DOWN (100)ms
worker      | [health] 1 UP (1)ms
worker      | [ERROR] Failed to process payment, payment reenqued 7a83aed0-d3ca-4afb-9982-f6107f3f64bc: EOF
worker      | [ERROR] Failed to process payment, payment reenqued fc052abe-b67c-4df1-b1c3-91671827e0f7: EOF
worker      | [ERROR] Failed to process payment, payment reenqued 15d8a10a-c262-4209-893e-a302ee04c85a: EOF
worker      | [ERROR] Failed to process payment, payment reenqued fd51fadb-c7a8-45db-a914-a58db34e1e60: EOF
worker      | [health] 0 DOWN (2000)ms
worker      | [health] 1 DOWN (1000)ms
worker      | [ERROR] Failed to process payment, payment reenqued 5b4aa563-c13c-408a-b1d0-5fddd606f48b: EOF
worker      | [ERROR] Failed to process payment, payment reenqued 919c9242-a04f-4d86-a681-9ff465a5cb0a: EOF
worker      | [ERROR] Failed to process payment, payment reenqued 05f5a014-e6f9-49d9-b1cf-1c1eb5a22052: EOF
worker      | [ERROR] Failed to process payment, payment reenqued ff23bee5-db37-4000-bc72-98792c81463d: EOF
worker      | [health] 0 DOWN (2000)ms
worker      | [health] 1 DOWN (1000)ms
worker      | [health] 0 UP (20)ms
worker      | [health] 1 UP (20)ms
redis       | 1:M 04 Aug 2025 13:29:41.036 * 10000 changes in 60 seconds. Saving...
redis       | 1:M 04 Aug 2025 13:29:41.037 * Background saving started by pid 30
redis       | 30:C 04 Aug 2025 13:29:41.130 * DB saved on disk
redis       | 30:C 04 Aug 2025 13:29:41.131 * Fork CoW for RDB: current 1 MB, peak 1 MB, average 0 MB
redis       | 1:M 04 Aug 2025 13:29:41.202 * Background saving terminated with success
worker      | [health] 0 UP (20)ms
worker      | [health] 1 UP (20)ms
worker      | [health] 0 UP (1)ms
worker      | [health] 1 UP (5000)ms
worker      | [health] 0 UP (1)ms
worker      | [health] 1 UP (5000)ms
[Knginx-lb exited with code 0
api2        | 2025/08/04 13:29:57 INFO shutting down server...
api1        | 2025/08/04 13:29:57 INFO shutting down server...
worker      | [health] 0 UP (1)ms
worker      | [health] 1 UP (5000)ms
[Kapi2 exited with code 0
[Kapi1 exited with code 0
[Kworker exited with code 137
redis       | 1:signal-handler (1754314208) Received SIGTERM scheduling shutdown...
redis       | 1:M 04 Aug 2025 13:30:08.561 * User requested shutdown...
redis       | 1:M 04 Aug 2025 13:30:08.561 * Saving the final RDB snapshot before exiting.
redis       | 1:M 04 Aug 2025 13:30:08.625 * DB saved on disk
redis       | 1:M 04 Aug 2025 13:30:08.625 # Redis is now ready to exit, bye bye...
[Kpayment-db exited with code 0
[Kredis exited with code 0
log truncated at line 1000
